<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>分野体験 - DX×AIが変える、10年後の日本</title>
  <link rel="stylesheet" href="assets/css/base.css">
  <link rel="stylesheet" href="assets/css/domain.css">
  <link rel="stylesheet" href="assets/css/domain-responsive.css">
  <script src="assets/js/api-client.js"></script>
</head>
<body>
  <header class="domain-header">
    <div class="container">
      <nav class="breadcrumb">
        <a href="#" id="backToHub" class="breadcrumb-link">← 分野一覧に戻る</a>
        <a href="strategy.html" class="strategy-board-link">🎮 戦略ボードに戻る →</a>
      </nav>
      <h1 id="domainTitle" class="domain-title">
        <span id="domainEmoji"></span>
        <span id="domainName"></span>
      </h1>
      <p id="domainIntro" class="domain-intro"></p>
    </div>
  </header>

  <main class="domain-main">
    <div class="container">
      <!-- 体験モード選択（ゲームモードのみ表示） -->
      <div class="experience-mode-selector" id="experienceModeSelector">
        <div class="mode-toggle">
          <button class="toggle-btn active" data-experience="game">
            🎮 ゲームモード
            <span class="mode-hint">簡潔で分かりやすい</span>
          </button>
          <button class="toggle-btn" data-experience="demo">
            📊 デモモード
            <span class="mode-hint">実際のスケール感</span>
          </button>
        </div>
        <div class="mode-description">
          <div class="description-content active" id="gameDescription">
            <strong>🎮 ゲームモード：</strong> 簡略化されたデータで、DX・AIの効果を分かりやすく体験できます。ゲーム感覚で隠しポイントを獲得しましょう。
          </div>
          <div class="description-content" id="demoDescription">
            <strong>📊 デモモード：</strong> 実際の規模に近いデータ量で、リアルなDX・AI導入の効果を体験できます。より詳細な分析が可能です。
          </div>
        </div>
      </div>

      <!-- モード切替 -->
      <nav class="mode-switcher" role="tablist" aria-label="DXステージ選択">
        <button class="mode-btn active" data-mode="plain" role="tab" aria-selected="true">
          <span class="mode-label">①電子化</span>
          <span class="mode-desc">Plain</span>
        </button>
        <button class="mode-btn" data-mode="smart" role="tab" aria-selected="false">
          <span class="mode-label">②工夫</span>
          <span class="mode-desc">Smart</span>
        </button>
        <button class="mode-btn" data-mode="ai" role="tab" aria-selected="false">
          <span class="mode-label">③AI導入</span>
          <span class="mode-desc">AI</span>
        </button>
        <button class="mode-btn" data-mode="summary" role="tab" aria-selected="false">
          <span class="mode-label">④まとめ</span>
          <span class="mode-desc">Summary</span>
        </button>
      </nav>

      <!-- メトリクス比較バー（折りたたみ可能） -->
      <div class="collapsible-header" id="metricsToggle" role="button" tabindex="0" aria-expanded="true">
        <h3 style="margin: 0; font-size: 1rem; font-weight: 600;">📊 モード比較グラフ</h3>
        <span class="collapse-icon">▼</span>
      </div>
      <div id="metricsContainer" class="metrics-container collapsible-content" style="display: grid;">
        <div class="metric-card">
          <div class="metric-label">提出書類</div>
          <div class="metric-row">
            <span class="metric-row-label">Plain</span>
            <div class="metric-bar">
              <div id="metricDocsPlain" class="metric-bar-fill plain"></div>
            </div>
            <span id="metricDocsPlainValue" class="metric-row-value">-</span>
          </div>
          <div class="metric-row">
            <span class="metric-row-label">Smart</span>
            <div class="metric-bar">
              <div id="metricDocsSmart" class="metric-bar-fill smart"></div>
            </div>
            <span id="metricDocsSmartValue" class="metric-row-value">-</span>
          </div>
          <div class="metric-row">
            <span class="metric-row-label">AI</span>
            <div class="metric-bar">
              <div id="metricDocsAi" class="metric-bar-fill ai"></div>
            </div>
            <span id="metricDocsAiValue" class="metric-row-value">-</span>
          </div>
        </div>
        <div class="metric-card">
          <div class="metric-label">入力項目</div>
          <div class="metric-row">
            <span class="metric-row-label">Plain</span>
            <div class="metric-bar">
              <div id="metricInputPlain" class="metric-bar-fill plain"></div>
            </div>
            <span id="metricInputPlainValue" class="metric-row-value">-</span>
          </div>
          <div class="metric-row">
            <span class="metric-row-label">Smart</span>
            <div class="metric-bar">
              <div id="metricInputSmart" class="metric-bar-fill smart"></div>
            </div>
            <span id="metricInputSmartValue" class="metric-row-value">-</span>
          </div>
          <div class="metric-row">
            <span class="metric-row-label">AI</span>
            <div class="metric-bar">
              <div id="metricInputAi" class="metric-bar-fill ai"></div>
            </div>
            <span id="metricInputAiValue" class="metric-row-value">-</span>
          </div>
        </div>
        <div class="metric-card">
          <div class="metric-label">⏱️ 推定入力時間</div>
          <div class="metric-row">
            <span class="metric-row-label">紙の書類</span>
            <div class="metric-bar">
              <div id="metricTimePaper" class="metric-bar-fill paper" style="background: #999;"></div>
            </div>
            <span id="metricTimePaperValue" class="metric-row-value">-</span>
          </div>
          <div class="metric-row">
            <span class="metric-row-label">Plain</span>
            <div class="metric-bar">
              <div id="metricTimePlain" class="metric-bar-fill plain"></div>
            </div>
            <span id="metricTimePlainValue" class="metric-row-value">-</span>
          </div>
          <div class="metric-row">
            <span class="metric-row-label">Smart</span>
            <div class="metric-bar">
              <div id="metricTimeSmart" class="metric-bar-fill smart"></div>
            </div>
            <span id="metricTimeSmartValue" class="metric-row-value">-</span>
          </div>
          <div class="metric-row">
            <span class="metric-row-label">AI</span>
            <div class="metric-bar">
              <div id="metricTimeAi" class="metric-bar-fill ai"></div>
            </div>
            <span id="metricTimeAiValue" class="metric-row-value">-</span>
          </div>
        </div>
      </div>

      <!-- メインコンテンツエリア -->
      <div class="domain-layout">
        <!-- 左: プロファイル表示 -->
        <aside class="domain-sidebar">
          <section class="profile-section">
            <h3>👤 前提条件</h3>
            <div id="profileDisplay" class="profile-display">
              <!-- domain.jsで生成 -->
            </div>
          </section>
        </aside>

        <!-- 右: 結果表示 -->
        <section class="domain-content">
          <div class="content-header">
            <h2 id="modeTitle"></h2>
            <p id="modeDesc" class="mode-description"></p>
          </div>

          <!-- Plain/Smart/AIモードの結果パネル -->
          <div id="modeResultContainer">
            <!-- Plain モード -->
            <div id="plainResult" class="result-panel result-plain">
              <h3>📋 必要書類一覧</h3>
              <div id="plainDocuments" class="documents-list">
                <!-- ドキュメント一覧は domain.js で生成 -->
              </div>
            </div>

            <!-- Smart モード -->
            <div id="smartResult" class="result-panel result-smart" style="display: none;">
              <h3>📋 必要書類（スマート判定）</h3>
              <div id="smartDocuments" class="documents-list">
                <!-- ドキュメント一覧は domain.js で生成 -->
              </div>
              <div class="smart-note" id="smartWarningsSection" style="display: none;">
                <p>⚠️ 以下の項目は手動判断が必要です</p>
                <ul id="smartWarnings"></ul>
              </div>
            </div>

            <!-- AI モード -->
            <div id="aiResult" class="result-panel result-ai" style="display: none;">
              <!-- 仮説ログ -->
              <div id="aiHypothesisPanel" class="ai-hypothesis-panel" style="display: none;" aria-live="polite">
                <h3>🤖 AI が状況を分析中...</h3>
                <div id="aiHypothesisLog" class="ai-hypothesis-log"></div>
              </div>

              <!-- 可変質問パネル -->
              <div id="aiBranchQuestions" class="ai-branch-questions" style="display: none;" aria-live="polite">
                <h3>📝 詳細を確認します</h3>
                <p class="branch-description">より正確に必要書類を絞り込むため、いくつか質問させてください。</p>
                <div id="branchQuestionContainer" class="branch-question-container">
                  <!-- 質問は動的に生成 -->
                </div>
              </div>

              <!-- 確定ログ -->
              <div id="aiConfirmLog" class="ai-confirm-log" style="display: none;" aria-live="polite">
                <h3>✅ 判断結果</h3>
                <div id="aiConfirmLogContent" class="ai-confirm-log-content"></div>
              </div>

              <!-- 書類リスト -->
              <div id="aiDocumentsPanel" style="display: none;">
                <h3>📋 あなたに必要な書類（最小セット）</h3>
                <div id="aiDocuments" class="documents-list ai-documents">
                  <!-- ドキュメント一覧は domain.js で生成 -->
                </div>
                <div class="simulation-note">
                  <p>💡 本デモは一般的な想定に基づくシミュレーションです。実際の運用は各機関の指示に従ってください。</p>
                </div>
              </div>
            </div>

            <!-- Summary モード -->
            <div id="summaryResult" class="result-panel result-summary" style="display: none;">
              <h3>📊 全体のまとめ</h3>
              
              <!-- 積み上げ棒グラフ -->
              <div class="viz-container">
                <h4>入力項目の削減状況</h4>
                <div id="summaryVizCanvas" class="viz-canvas">
                  <!-- viz.jsで生成 -->
                </div>
                <div class="viz-legend">
                  <span class="legend-item"><span class="legend-color manual"></span>手入力</span>
                  <span class="legend-item"><span class="legend-color auto"></span>自動</span>
                  <span class="legend-item"><span class="legend-color removed"></span>不要</span>
                </div>
              </div>

              <!-- 統計サマリー -->
              <div class="summary-stats">
                <div class="stat-card">
                  <div class="stat-label">提出書類数</div>
                  <div class="stat-comparison">
                    <div class="stat-item">
                      <span class="stat-mode">Plain</span>
                      <span class="stat-value" id="summaryDocsPlain">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-mode">Smart</span>
                      <span class="stat-value" id="summaryDocsSmart">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-mode">AI</span>
                      <span class="stat-value highlight" id="summaryDocsAi">-</span>
                    </div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-label">入力項目数</div>
                  <div class="stat-comparison">
                    <div class="stat-item">
                      <span class="stat-mode">Plain</span>
                      <span class="stat-value" id="summaryInputPlain">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-mode">Smart</span>
                      <span class="stat-value" id="summaryInputSmart">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-mode">AI</span>
                      <span class="stat-value highlight" id="summaryInputAi">-</span>
                    </div>
                  </div>
                </div>                <div class="stat-card">
                  <div class="stat-label">⏱️ 推定入力時間</div>
                  <div class="stat-comparison">
                    <div class="stat-item">
                      <span class="stat-mode">紙の書類</span>
                      <span class="stat-value" id="summaryTimePaper">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-mode">Plain</span>
                      <span class="stat-value" id="summaryTimePlain">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-mode">Smart</span>
                      <span class="stat-value" id="summaryTimeSmart">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-mode">AI</span>
                      <span class="stat-value highlight" id="summaryTimeAi">-</span>
                    </div>
                  </div>
                </div>              </div>

              <!-- 削減効果 -->
              <div class="reduction-highlight">
                <h4>🎯 AI導入による削減効果</h4>
                <div class="reduction-stats">
                  <div class="reduction-item">
                    <span class="reduction-label">書類削減率</span>
                    <span class="reduction-value" id="summaryDocsReduction">-</span>
                  </div>
                  <div class="reduction-item">
                    <span class="reduction-label">入力削減率</span>
                    <span class="reduction-value" id="summaryInputReduction">-</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 統計情報 -->
          <div class="stats-panel" id="statsPanel">
            <p id="docStats"></p>
          </div>
        </section>
      </div>

      <!-- 注意書き -->
      <div class="domain-disclaimer">
        <p><strong>※ デモ前提について</strong></p>
        <p>本デモは制度・施設運用の単純化・誇張を含みます。実際の効果は法令・医療機関・保険者・自治体の体制により異なります。マイナンバーカードで一元管理できる範囲も各機関で異なります。</p>
      </div>

      <!-- 隠しポイントチャレンジ -->
      <div id="hiddenPointChallenge" class="hidden-point-challenge" style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 12px; border: 2px solid #f59e0b; display: none;">
        <h3 style="margin: 0 0 1rem 0; font-size: 1.2rem; color: #92400e;">🎁 隠しポイントチャレンジ</h3>
        <p id="challengeDescription" style="margin-bottom: 1rem; color: #78350f;"></p>
        <button id="unlockPointBtn" class="unlock-point-btn" style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
          チャレンジを達成する
        </button>
      </div>
    </div>
  </main>

  <script src="assets/js/state.js"></script>
  <script src="assets/js/viz.js"></script>
  <script src="assets/js/domain.js"></script>
</body>
</html>
